<p>Deserializing objects is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17672">CVE-2017-17672</a>: vBulletin: Unserialize PHP Code Execution </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000058">CVE-2018-1000058</a>: Jenkins Pipeline: arbitrary code execution
  vulnerability </li>
</ul>
<p>Object deserialization from an untrusted source can lead to unexpected code execution. Deserialization takes a stream of bits and turns it into an
object. If the stream contains the type of object you expect, all is well. But if you're deserializing untrusted input, and an attacker has inserted
some other type of object, you're in trouble. Why? There are a few different attack scenarios, but one widely-documented one goes like this:
Deserialization first instantiates the <code>Object</code>, then PHP will automatically attempt to call the <code>__wakeup()</code> member to
reconstruct any resources that the object may have. If the attacker has overridden <code>__wakeup()</code> then he is entirely in control of what code
executes during that process.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> an attacker could have tampered with the source provided to the deserialization function </li>
  <li> you are using an unsafe deserialization function </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To prevent insecure deserialization, it is recommended to use a standard data interchange format such as JSON instead of relying on objects
serialization.</p>
<p>You should also limit access to the serialized source. For example:</p>
<ul>
  <li> if it is a file, restrict the access to it. </li>
  <li> if it comes from the network, restrict who has access to the process, such as with a Firewall or by authenticating the sender first. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/502.html">MITRE, CWE-502</a> - Deserialization of Untrusted Data </li>
  <li> OWASP Top 10 2017 Category A8 - Insecure Deserialization </li>
  <li> <a href="https://www.owasp.org/index.php/Deserialization_of_untrusted_data">OWASP Deserialization of untrusted data</a> </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#OBJECT_DESERIALIZATION">OBJECT_DESERIALIZATION </a> </li>
</ul>

