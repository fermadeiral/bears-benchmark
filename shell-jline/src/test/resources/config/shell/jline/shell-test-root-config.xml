<!DOCTYPE aspectran PUBLIC "-//ASPECTRAN//DTD Aspectran Configuration 5.0//EN"
                           "http://aspectran.github.io/dtd/aspectran-5.dtd">

<aspectran>

    <description style="apon">
        |Commands that can run the examples:
        |   hello     Runs the helloWorld() method of the sampleAction bean and prints the returned value to the console.
        |   echo      It accepts parameters and print them to the console.
        |   login     It accepts parameters used for login and print them to the console.
        |   chpw      It accepts parameters for changing the password and print them to the console.
        |   free      It uses the Freemarker template engine to output the values of the input parameters to the console.
        |   select    This example generates a simple SQL SELECT statement using the Freemarker template engine.
        |   update    This example generates a simple SQL UPDATE statement using the Freemarker template engine.
        |
    </description>

    <bean id="sampleAction" class="com.aspectran.shell.sample.SampleAction">
        <description>
            Defines one sample action that contains the helloWorld method.
        </description>
    </bean>

    <bean id="sampleAdvice" class="com.aspectran.shell.sample.SampleAdvice">
        <description>
            Action Method 실행 전 후에 주입할 Advice Action Method를 가지고 있는
            singleton 스코프를 가지는 Bean을 정의합니다.
        </description>
    </bean>

    <aspect id="sampleAdviceAspect">
        <description>
            sampleAction Bean의 helloWorld 메쏘드를 실행하는 Translet이 발견되면,
            해당 Translet의 실행 전에는 sampleAdvice Bean의 welcome 메쏘드를 실행하고,
            해당 Translet의 실행 후에는 sampleAdvice Bean의 goodbye 메쏘드를 실행합니다.
        </description>
        <joinpoint target="translet">
            pointcut: {
                +: hello@sampleAction^helloWorld
            }
        </joinpoint>
        <advice bean="sampleAdvice">
            <before>
                <action method="welcome"/>
            </before>
            <after>
                <action method="goodbye"/>
            </after>
        </advice>
    </aspect>

    <translet name="hello">
        <description>
            sampleAction 빈에서 helloWorld 메쏘드를 실행합니다.
            helloWorld 메쏘드가 반환하는 "Hello, World." 문자열을 텍스트 형식의 컨텐츠로 응답합니다.
        </description>
        <transform type="transform/text">
            <action id="helloData" bean="sampleAction" method="helloWorld"/>
        </transform>
    </translet>

    <translet name="echo">
        <description style="apon">
            |
            |   It accepts parameters and print them to the console.
            |
        </description>
        <request>
            <parameters>
                <item name="input-1">${prefix} - 1</item>
                <item name="input-2">${prefix} - 2</item>
                <item name="input-3">${prefix} - 3</item>
            </parameters>
        </request>
        <transform type="transform/text" contentType="text/plain">
            <template engine="token" style="apon">
                |---------------------------------------------------
                |The parameters you entered are:
                |---------------------------------------------------
                |input-1: ${input-1}
                |input-2: ${input-2}
                |input-3: ${input-3}
                |---------------------------------------------------
                |Templated by Built-in engine
                |---------------------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="echo2">
        <description style="apon">
            |
            |   It accepts parameters and print them to the console.
            |
        </description>
        <request>
            <parameters>
                <item name="input-1">PARA ${input-1:12345}</item>
                <item name="input-2">PARA ${input-2:67890}</item>
                <item name="input-3">PARA ${input-3-1} and ${input-3-2}</item>
            </parameters>
            <attributes>
                <item name="input-4">ATTR ${input-4}</item>
            </attributes>
        </request>
        <transform type="transform/text" contentType="text/plain">
            <template engine="token" style="apon">
                |---------------------------------------------------
                |The input parameters and attributes are as follows:
                |---------------------------------------------------
                |input-1: ${input-1} - This is a parameter.
                |input-2: ${input-2} - This is a parameter.
                |input-3: ${input-3} - This is a parameter.
                |input-4: @{input-4} - This is an attribute.
                |---------------------------------------------------
                |Templated by Built-in engine
                |---------------------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="login">
        <description style="apon">
            |
            |   If you enter the required ID and password for login, it will be printed on the console.
            |
        </description>
        <request>
            <parameters>
                <item name="email">${emailId}@${emailDomain}</item>
                <item name="password" security="true"/>
            </parameters>
        </request>
        <transform type="transform/text">
            <template style="apon">
                |-----------------------------------------
                | You entered the following for login:
                |   email: ${email}
                |   password: ${password}
                |-----------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="chpw">
        <description style="apon">
            |
            | If you enter parameters to change the password, it will be printed on the console.
            |
        </description>
        <request>
            <parameters>
                <item name="email">${emailId}@${emailDomain}</item>
                <item name="password" security="true"/>
                <item name="confirmPassword" security="true"/>
            </parameters>
        </request>
        <transform type="transform/text">
            <template style="apon">
                |--------------------------------------------------------
                | You entered the following to change your password:
                |   email: ${email}
                |   password: ${password}
                |   confrim password: ${confirmPassword}
                |--------------------------------------------------------
            </template>
        </transform>
    </translet>

    <append resource="config/shell/jline/freemarker-translets.xml"/>

</aspectran>